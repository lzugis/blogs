import{_ as s,o as a,c as i,R as n,ae as l,af as e,ag as t,ah as p,ai as h,aj as r}from"./chunks/framework.gTuukKyl.js";const C=JSON.parse('{"title":"切片与网格集","description":"","frontmatter":{},"headers":[],"relativePath":"docs/advance/tile.md","filePath":"docs/advance/tile.md"}'),k={name:"docs/advance/tile.md"},o=n('<h1 id="切片与网格集" tabindex="-1">切片与网格集 <a class="header-anchor" href="#切片与网格集" aria-label="Permalink to &quot;切片与网格集&quot;">​</a></h1><div class="tip custom-block"><p class="custom-block-title">概览</p><p>本章主要讲述Geoserver中切片相关的参数。包括：</p><ul><li>切片原理</li><li>网格集</li><li>磁盘定额和BlobStores</li><li>切片图层和图层预切片</li></ul></div><h2 id="一、切片原理" tabindex="-1">一、切片原理 <a class="header-anchor" href="#一、切片原理" aria-label="Permalink to &quot;一、切片原理&quot;">​</a></h2><p>切片原理参考csdn文章<a href="http://t.csdnimg.cn/cFcEm" target="_blank" rel="noreferrer">WEBGIS基础（地图切片）</a>.</p><h2 id="二、网格集" tabindex="-1">二、网格集 <a class="header-anchor" href="#二、网格集" aria-label="Permalink to &quot;二、网格集&quot;">​</a></h2><h3 id="_1-网格集列表" tabindex="-1">1.网格集列表 <a class="header-anchor" href="#_1-网格集列表" aria-label="Permalink to &quot;1.网格集列表&quot;">​</a></h3><p>点击左侧菜单&quot;Tile Caching -&gt; 网格集&quot;进入网格集列表页面，在页面上方提供了“添加新网格集”和“删除已选网格集”按钮。网格集列表包括如下字段：</p><ul><li>网格集：定义的网格集名称</li><li>坐标系：网格集的坐标系</li><li>切片大小：切片的大小</li><li>缩放层级：最大的缩放层级</li><li>硬盘占用：磁盘占用情况</li></ul><p>同时在每个网格集后面提供了快捷按钮“创建副本”，可以复制当前网格集。</p><h3 id="_2-添加-编辑网格集" tabindex="-1">2. 添加/编辑网格集 <a class="header-anchor" href="#_2-添加-编辑网格集" aria-label="Permalink to &quot;2. 添加/编辑网格集&quot;">​</a></h3><p>点击“添加新网格集”跳转到新建网格集页面，如下图所示。定义网格集的参数有：</p><ul><li><strong>名称</strong>：网格集的名称,如<code>Tile512</code></li><li><strong>坐标系</strong>：网格集的坐标系,如<code>EPSG:3857</code></li><li><strong>网格集边界</strong>：网格集的边界范围，如<code>[-20037508.34,-20037508.34,20037508.34,20037508.34]</code></li><li><strong>切片大小</strong>：切片的宽度和高度,如<code>[512, 512]</code></li><li><strong>Tile Matrix Set</strong>：定义切片每一级的分辨率等信息</li></ul><p><img src="'+l+`" alt="" data-fancybox="gallery"></p><p>每一级的分辨率等信息可通过如下代码进行计算：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 512</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">origin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20037508.34</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">minZoom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">maxZoom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 18</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> res</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> zoom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minZoom; zoom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> maxZoom; zoom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(zoom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    res.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([zoom, (origin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> size])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    res.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([zoom, res[res.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(res.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;-&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\r\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><p>计算得到的值如下：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>0-&gt;78271.516953125</span></span>
<span class="line"><span>1-&gt;39135.7584765625</span></span>
<span class="line"><span>2-&gt;19567.87923828125</span></span>
<span class="line"><span>3-&gt;9783.939619140625</span></span>
<span class="line"><span>4-&gt;4891.9698095703125</span></span>
<span class="line"><span>5-&gt;2445.9849047851562</span></span>
<span class="line"><span>6-&gt;1222.9924523925781</span></span>
<span class="line"><span>7-&gt;611.4962261962891</span></span>
<span class="line"><span>8-&gt;305.74811309814453</span></span>
<span class="line"><span>9-&gt;152.87405654907226</span></span>
<span class="line"><span>10-&gt;76.43702827453613</span></span>
<span class="line"><span>11-&gt;38.218514137268066</span></span>
<span class="line"><span>12-&gt;19.109257068634033</span></span>
<span class="line"><span>13-&gt;9.554628534317017</span></span>
<span class="line"><span>14-&gt;4.777314267158508</span></span>
<span class="line"><span>15-&gt;2.388657133579254</span></span>
<span class="line"><span>16-&gt;1.194328566789627</span></span>
<span class="line"><span>17-&gt;0.5971642833948135</span></span>
<span class="line"><span>18-&gt;0.29858214169740677</span></span></code></pre></div><p>定义好切片规则后使用该切片时的参数如下：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>http://localhost:8080/geoserver/gwc/service/wmts?</span></span>
<span class="line"><span> layer=lzugis:base_province&amp;</span></span>
<span class="line"><span> tilematrixset=Tile512&amp;</span></span>
<span class="line"><span> Service=WMTS&amp;</span></span>
<span class="line"><span> Request=GetTile&amp;</span></span>
<span class="line"><span> Version=1.0.0&amp;</span></span>
<span class="line"><span> Format=image/png&amp;</span></span>
<span class="line"><span> TileMatrix=zoom4&amp;</span></span>
<span class="line"><span> TileCol=12&amp;</span></span>
<span class="line"><span> TileRow=6</span></span></code></pre></div><h3 id="_3-删除网格集" tabindex="-1">3. 删除网格集 <a class="header-anchor" href="#_3-删除网格集" aria-label="Permalink to &quot;3. 删除网格集&quot;">​</a></h3><p>点击选中网格集，点击“删除已选网格集”按钮，弹出确认对话框，点击“确定”即可删除。</p><h2 id="三-切片默认配置" tabindex="-1">三. 切片默认配置 <a class="header-anchor" href="#三-切片默认配置" aria-label="Permalink to &quot;三. 切片默认配置&quot;">​</a></h2><p>点击左侧菜单“Tile Caching -&gt; Caching Defaults”进入切片默认配置页面，该页面用于配置切片默认配置，是一个全局配置，页面如下图所示。 <img src="`+e+'" alt="" data-fancybox="gallery"></p><p>切片全局配置包括：</p><ul><li>Provided Services：提供的服务 <ul><li>Enable direct integration with GeoServer WMS（跟Geoserver的WMS直接集成）</li><li>Explicitly require TILED Parameter（明文显示切片参数）</li><li>Enable WMS-C Service（启用WMS-C服务）</li><li>Enable TMS Service（启用TMS服务）</li><li>Enable Data Security（启用数据安全）</li></ul></li><li>Default Caching Options for GeoServer Layers <ul><li>Default Tile Image Formats for（默认格式）</li><li>Default Cached Gridsets（默认网格集）</li></ul></li></ul><h2 id="四、disk-quota磁盘定额" tabindex="-1">四、Disk Quota磁盘定额 <a class="header-anchor" href="#四、disk-quota磁盘定额" aria-label="Permalink to &quot;四、Disk Quota磁盘定额&quot;">​</a></h2><p>如无特殊需求，此配置一般不做修改。可根据实际情况进行调整。</p><h2 id="五、blobstores" tabindex="-1">五、BlobStores <a class="header-anchor" href="#五、blobstores" aria-label="Permalink to &quot;五、BlobStores&quot;">​</a></h2><h3 id="_1-列表" tabindex="-1">1. 列表 <a class="header-anchor" href="#_1-列表" aria-label="Permalink to &quot;1. 列表&quot;">​</a></h3><p>点击左侧菜单“Tile Caching -&gt; BlobStores”进入BlobStores管理页面，该页面用于配置BlobStores，是一个全局配置，页面如下图所示。</p><p><img src="'+t+'" alt="" data-fancybox="gallery"></p><h3 id="_2-新增-修改" tabindex="-1">2. 新增/修改 <a class="header-anchor" href="#_2-新增-修改" aria-label="Permalink to &quot;2. 新增/修改&quot;">​</a></h3><p>点击“Add New”按钮，进入到新增页面，如下图所示。 <img src="'+p+'" alt="" data-fancybox="gallery"> 新增信息包括：</p><ul><li>类型，选择类型为File BlobStore，为文件型存储；</li><li>名称，输入名称；</li><li>是否启用</li><li>是否默认</li><li>Base Directory，基础路径</li><li>File System Block Size，文件大小，根据需求进行修改，默认为4096</li><li>Tiles directory layout，文件组织形式，可选择<code>GeoWebCache default</code>、<code>TMS layout</code>、<code>SLIPPY</code>；</li></ul><h2 id="六、切片图层" tabindex="-1">六、切片图层 <a class="header-anchor" href="#六、切片图层" aria-label="Permalink to &quot;六、切片图层&quot;">​</a></h2><h3 id="_1-切片图层列表" tabindex="-1">1. 切片图层列表 <a class="header-anchor" href="#_1-切片图层列表" aria-label="Permalink to &quot;1. 切片图层列表&quot;">​</a></h3><p>点击左侧菜单“Tile Caching -&gt; 切片图层”进入切片图层页面，界面如下。 <img src="'+h+'" alt="" data-fancybox="gallery"> 在列表上方有三个按钮：“添加新的缓存图层&quot;、”移除新的缓存图层“、”清空所有缓存“。列表信息包括：</p><ul><li>类型：图层类型，以图标的方式展示</li><li>图层名称</li><li>硬盘配额</li><li>硬盘占用</li><li>BlobStore</li><li>启用</li><li>预览，根据默认切片参数和切片图层定义时指定的格式，提供通过openlayers进行预览的功能</li><li>操作，包括<code>Seed/Truncate</code>和<code>Empty</code>两个操作。</li></ul><h3 id="_2-添加新的缓存图层" tabindex="-1">2. 添加新的缓存图层 <a class="header-anchor" href="#_2-添加新的缓存图层" aria-label="Permalink to &quot;2. 添加新的缓存图层&quot;">​</a></h3><p>点击“添加新的缓存图层”按钮可添加新的切片图层，不过一般在新增图层（组）的时候已经定义好了切片图层。</p><h3 id="_3-预切片与清空" tabindex="-1">3. 预切片与清空 <a class="header-anchor" href="#_3-预切片与清空" aria-label="Permalink to &quot;3. 预切片与清空&quot;">​</a></h3><p>点击操作列&quot;Seed/Truncate&quot;,进入预切片界面，如下图所示。 <img src="'+r+'" alt="" data-fancybox="gallery"></p><p>设置<code>Create a new task</code>下的参数，开始进行预切片。</p><p>点击<code>Empty</code>清空已有的切片。</p><h3 id="_4-删除切片图层" tabindex="-1">4. 删除切片图层 <a class="header-anchor" href="#_4-删除切片图层" aria-label="Permalink to &quot;4. 删除切片图层&quot;">​</a></h3><p>选中图层，点击上方”移除新的缓存图层“即可删除。</p><h3 id="_5-清空所有缓存" tabindex="-1">5. 清空所有缓存 <a class="header-anchor" href="#_5-清空所有缓存" aria-label="Permalink to &quot;5. 清空所有缓存&quot;">​</a></h3><p>点击”清空所有缓存“可清除所有缓存切片。</p>',48),d=[o];function c(g,E,y,u,m,F){return a(),i("div",null,d)}const _=s(k,[["render",c]]);export{C as __pageData,_ as default};
